-- MySQL Script generated by MySQL Workbench
-- Mon Jul  7 11:37:31 2014
-- Model: New Model    Version: 1.0
SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema AnatomicalAtlas
-- -----------------------------------------------------
DROP DATABASE IF EXISTS `AnatomicalAtlas`;
CREATE SCHEMA IF NOT EXISTS `AnatomicalAtlas` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ;
USE `AnatomicalAtlas` ;

-- -----------------------------------------------------
-- Table `AnatomicalAtlas`.`Teacher`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `AnatomicalAtlas`.`Teacher` ;

CREATE TABLE IF NOT EXISTS `AnatomicalAtlas`.`Teacher` (
  `idTeacher` INT NOT NULL AUTO_INCREMENT,
  `Name` VARCHAR(128) NOT NULL,
  `Photo` BLOB NULL,
  `Resume` TEXT NULL,
  `Sex` ENUM('male', 'female'),
  `Birthday` DATE NULL,
  `Country` VARCHAR(128) NULL,
  `Scholarity` VARCHAR(128) NOT NULL,
  PRIMARY KEY (`idTeacher`))
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `AnatomicalAtlas`.`Organization`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `AnatomicalAtlas`.`Organization` ;

CREATE TABLE IF NOT EXISTS `AnatomicalAtlas`.`Organization` (
  `idOrganization` INT NOT NULL AUTO_INCREMENT,
  `Name` VARCHAR(128) NOT NULL,
  `Acronym` VARCHAR(128) NULL,
  `Country` VARCHAR(128) NOT NULL,
  `Teacher_idResponsible` INT NOT NULL,
  PRIMARY KEY (`idOrganization`),
  INDEX `fk_Organization_Teacher2_idx` (`Teacher_idResponsible` ASC),
  CONSTRAINT `fk_Organization_Teacher2`
    FOREIGN KEY (`Teacher_idResponsible`)
    REFERENCES `AnatomicalAtlas`.`Teacher` (`idTeacher`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `AnatomicalAtlas`.`Class`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `AnatomicalAtlas`.`Class` ;

CREATE TABLE IF NOT EXISTS `AnatomicalAtlas`.`Class` (
  `idClass` INT NOT NULL AUTO_INCREMENT,
  `Name` VARCHAR(128) NOT NULL,
  `NumberOfStudents` INT NULL DEFAULT 0,
  `Teacher_idTeacher` INT NULL,
  `Organization_idOrganization` INT NULL,
  PRIMARY KEY (`idClass`),
  INDEX `fk_Class_Teacher2_idx` (`Teacher_idTeacher` ASC),
  INDEX `fk_Class_Organization2_idx` (`Organization_idOrganization` ASC),
  CONSTRAINT `fk_Class_Teacher2`
    FOREIGN KEY (`Teacher_idTeacher`)
    REFERENCES `AnatomicalAtlas`.`Teacher` (`idTeacher`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Class_Organization2`
    FOREIGN KEY (`Organization_idOrganization`)
    REFERENCES `AnatomicalAtlas`.`Organization` (`idOrganization`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `AnatomicalAtlas`.`Student`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `AnatomicalAtlas`.`Student` ;

CREATE TABLE IF NOT EXISTS `AnatomicalAtlas`.`Student` (
  `idStudent` INT NOT NULL AUTO_INCREMENT,
  `Organization_idOrganization` INT NOT NULL,
  `Name` VARCHAR(128) NOT NULL,
  `GeneralKnowledge` FLOAT ZEROFILL NULL, -- Knowledge Rate
  `Photo` BLOB NULL,
  `Resume` TEXT NULL,
  `Sex` ENUM('male', 'female'),
  `Birthday` DATE NULL,
  `Country` VARCHAR(128) NULL,
  `Scholarity` VARCHAR(128) NOT NULL,
  PRIMARY KEY (`idStudent`),
  INDEX `fk_Student_Organization2_idx` (`Organization_idOrganization` ASC),
  CONSTRAINT `fk_Student_Organization2`
    FOREIGN KEY (`Organization_idOrganization`)
    REFERENCES `AnatomicalAtlas`.`Organization` (`idOrganization`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `AnatomicalAtlas`.`Question`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `AnatomicalAtlas`.`Question` ;

CREATE TABLE IF NOT EXISTS `AnatomicalAtlas`.`Question` (
  `idQuestion` INT NOT NULL AUTO_INCREMENT,
  `Teacher_idQuestionOwner` INT NOT NULL,
  `PublicDomain` TINYINT(1) NOT NULL,
  PRIMARY KEY (`idQuestion`),
  INDEX `fk_Question_QuestionOwner2_idx` (`QuestionOwner_idQuestionOwner` ASC),
  CONSTRAINT `fk_Question_QuestionOwner2`
    FOREIGN KEY (`QuestionOwner_idQuestionOwner`)
    REFERENCES `AnatomicalAtlas`.`QuestionOwner` (`idQuestionOwner`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `AnatomicalAtlas`.`BoneSet`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `AnatomicalAtlas`.`BoneSet` ;

CREATE TABLE IF NOT EXISTS `AnatomicalAtlas`.`BoneSet` (
  `idBoneSet` INT NOT NULL AUTO_INCREMENT,
  `BoneSet_idParent` INT NULL,
  `Category` VARCHAR(45) NOT NULL,
  `Description` TEXT NOT NULL,
  `Synonymous` VARCHAR(128) NULL,
  `BoneNumber` INT NOT NULL,
  PRIMARY KEY (`idBoneSet`),
  INDEX `fk_BoneSet_BoneSet1_idx` (`BoneSet_idParent` ASC),
  CONSTRAINT `fk_BoneSet_BoneSet1`
  FOREIGN KEY (`BoneSet_idParent`)
  REFERENCES `AnatomicalAtlas`.`BoneSet` (`idBoneSet`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION)
  ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `AnatomicalAtlas`.`Bone`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `AnatomicalAtlas`.`Bone` ;

CREATE TABLE IF NOT EXISTS `AnatomicalAtlas`.`Bone` (
  `idBone` INT NOT NULL AUTO_INCREMENT,
  `BoneSet_idBoneSet` INT NOT NULL,
  `Description` TEXT NOT NULL,
  `Name` VARCHAR(128) NOT NULL,
  `Synonymous` VARCHAR(128) NULL,
  `BonePartNumber` INT NULL DEFAULT 0,
  PRIMARY KEY (`idBone`),
  INDEX `fk_Bone_BoneSet1_idx` (`BoneSet_idBoneSet` ASC),
  CONSTRAINT `fk_Bone_BoneSet1`
    FOREIGN KEY (`BoneSet_idBoneSet`)
    REFERENCES `AnatomicalAtlas`.`BoneSet` (`idBoneSet`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `AnatomicalAtlas`.`BonePart`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `AnatomicalAtlas`.`BonePart` ;

CREATE TABLE IF NOT EXISTS `AnatomicalAtlas`.`BonePart` (
  `idBonePart` INT NOT NULL AUTO_INCREMENT,
  `Bone_idBone` INT NOT NULL,
  `Description` TEXT NOT NULL,
  `Name` VARCHAR(128) NOT NULL,
  `Synonymous` VARCHAR(128) NULL,
  PRIMARY KEY (`idBonePart`),
  INDEX `fk_Bone_Bone1_idx` (`Bone_idBone` ASC),
  CONSTRAINT `fk_Bone_Bone1`
  FOREIGN KEY (`Bone_idBone`)
  REFERENCES `AnatomicalAtlas`.`Bone` (`idBone`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
  ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `AnatomicalAtlas`.`QuizTest`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `AnatomicalAtlas`.`QuizTest` ;

CREATE TABLE IF NOT EXISTS `AnatomicalAtlas`.`QuizTest` (
  `idQuizTest` INT NOT NULL AUTO_INCREMENT,
  `Teacher_idQuestionOwner` INT NOT NULL,
  `DifficultLevel` TINYINT UNSIGNED NULL,
  PRIMARY KEY (`idQuizTest`),
  INDEX `fk_QuizTest_Teacher1_idx` (`Teacher_idTeacher` ASC),
  CONSTRAINT `fk_QuizTest_Teacher1`
    FOREIGN KEY (`Teacher_idTeacher`)
    REFERENCES `AnatomicalAtlas`.`Teacher` (`idTeacher`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `AnatomicalAtlas`.`Resolution`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `AnatomicalAtlas`.`Resolution` ;

CREATE TABLE IF NOT EXISTS `AnatomicalAtlas`.`Resolution` (
  `idResolution` INT NULL,
  `QuizTest_idQuizTest` INT NOT NULL,
  `Student_idStudent` INT NOT NULL,
  `TotalCorrectAnswers` INT UNSIGNED NOT NULL,
  `TotalWrongAnswers` INT UNSIGNED NOT NULL,
  `TotalQuestions` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`idResolution`),
  INDEX `fk_QuizTest_has_Student_Student1_idx` (`Student_idStudent` ASC),
  INDEX `fk_QuizTest_has_Student_QuizTest1_idx` (`QuizTest_idQuizTest` ASC),
  CONSTRAINT `fk_QuizTest_has_Student_QuizTest1`
    FOREIGN KEY (`QuizTest_idQuizTest`)
    REFERENCES `AnatomicalAtlas`.`QuizTest` (`idQuizTest`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_QuizTest_has_Student_Student1`
    FOREIGN KEY (`Student_idStudent`)
    REFERENCES `AnatomicalAtlas`.`Student` (`idStudent`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `AnatomicalAtlas`.`TrueOrFalse`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `AnatomicalAtlas`.`TrueOrFalse` ;

CREATE TABLE IF NOT EXISTS `AnatomicalAtlas`.`TrueOrFalse` (
  `Question_idQuestion` INT NOT NULL,
  `CorrectAnswer` TINYINT(1) NOT NULL,
  `Statement` TEXT NOT NULL,
  `Figure` BLOB NULL,
  PRIMARY KEY (`Question_idQuestion`),
  CONSTRAINT `fk_TrueOrFalse_Question1`
    FOREIGN KEY (`Question_idQuestion`)
    REFERENCES `AnatomicalAtlas`.`Question` (`idQuestion`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `AnatomicalAtlas`.`MultipleChoice`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `AnatomicalAtlas`.`MultipleChoice` ;

CREATE TABLE IF NOT EXISTS `AnatomicalAtlas`.`MultipleChoice` (
  `Question_idQuestion` INT NOT NULL,
  `CorrectAnswer` ENUM('a','b','c','d','e') NOT NULL,
  `AnswerA` TEXT NOT NULL,
  `AnswerB` TEXT NOT NULL,
  `AnswerC` TEXT NULL,
  `AnswerD` TEXT NULL,
  `AnswerE` TEXT NULL,
  `Statement` TEXT NOT NULL,
  `Figure` BLOB NULL,
  PRIMARY KEY (`Question_idQuestion`),
  CONSTRAINT `fk_MultipleChoice_Question2`
    FOREIGN KEY (`Question_idQuestion`)
    REFERENCES `AnatomicalAtlas`.`Question` (`idQuestion`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `AnatomicalAtlas`.`BoneHasBone`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `AnatomicalAtlas`.`BoneHasBone` ;

CREATE TABLE IF NOT EXISTS `AnatomicalAtlas`.`BoneHasBone` (
  `Bone_idBone` INT NOT NULL,
  `Bone_idNeighbor` INT NOT NULL,
  PRIMARY KEY (`Bone_idBone`, `Bone_idNeighbor`),
  INDEX `fk_Bone_has_Bone_Bone4_idx` (`Bone_idNeighbor` ASC),
  INDEX `fk_Bone_has_Bone_Bone3_idx` (`Bone_idBone` ASC),
  CONSTRAINT `fk_Bone_has_Bone_Bone3`
  FOREIGN KEY (`Bone_idBone`)
  REFERENCES `AnatomicalAtlas`.`Bone` (`idBone`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Bone_has_Bone_Bone4`
  FOREIGN KEY (`Bone_idNeighbor`)
  REFERENCES `AnatomicalAtlas`.`Bone` (`idBone`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `AnatomicalAtlas`.`QuestionReferencesBoneSet`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `AnatomicalAtlas`.`QuestionReferencesBoneSet` ;

CREATE TABLE IF NOT EXISTS `AnatomicalAtlas`.`QuestionReferencesBoneSet` (
  `Question_idQuestion` INT NOT NULL,
  `BoneSet_idBoneSet` INT NOT NULL,
  PRIMARY KEY (`Question_idQuestion`, `BoneSet_idBoneSet`),
  INDEX `fk_BoneSet_has_Question_Question1_idx` (`Question_idQuestion` ASC),
  INDEX `fk_BoneSet_has_Question_BoneSet1_idx` (`BoneSet_idBoneSet` ASC),
  CONSTRAINT `fk_BoneSet_has_Question_BoneSet1`
  FOREIGN KEY (`BoneSet_idBoneSet`)
  REFERENCES `AnatomicalAtlas`.`BoneSet` (`idBoneSet`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_BoneSet_has_Question_Question1`
  FOREIGN KEY (`Question_idQuestion`)
  REFERENCES `AnatomicalAtlas`.`Question` (`idQuestion`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `AnatomicalAtlas`.`TeacherAuthoredQuestion`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `AnatomicalAtlas`.`TeacherAuthoredQuestion` ;

CREATE TABLE IF NOT EXISTS `AnatomicalAtlas`.`TeacherAuthoredQuestion` (
  `Teacher_idTeacher` INT NOT NULL,
  `Question_idQuestion` INT NOT NULL,
  PRIMARY KEY (`Teacher_idTeacher`, `Question_idQuestion`),
  INDEX `fk_Teacher_has_Question_Question3_idx` (`Question_idQuestion` ASC),
  INDEX `fk_Teacher_has_Question_Teacher3_idx` (`Teacher_idTeacher` ASC),
  CONSTRAINT `fk_Teacher_has_Question_Teacher3`
  FOREIGN KEY (`Teacher_idTeacher`)
  REFERENCES `AnatomicalAtlas`.`Teacher` (`idTeacher`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Teacher_has_Question_Question3`
  FOREIGN KEY (`Question_idQuestion`)
  REFERENCES `AnatomicalAtlas`.`Question` (`idQuestion`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `AnatomicalAtlas`.`TeacherWorkAtOrganization`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `AnatomicalAtlas`.`TeacherWorkAtOrganization` ;

CREATE TABLE IF NOT EXISTS `AnatomicalAtlas`.`TeacherWorkAtOrganization` (
  `Teacher_idEmployee` INT NOT NULL,
  `Organization_idOrganization` INT NOT NULL,
  PRIMARY KEY (`Teacher_idEmployee`, `Organization_idOrganization`),
  INDEX `fk_Organization_has_Teacher_Teacher1_idx` (`Teacher_idEmployee` ASC),
  INDEX `fk_Organization_has_Teacher_Organization1_idx` (`Organization_idOrganization` ASC),
  CONSTRAINT `fk_Organization_has_Teacher_Organization1`
  FOREIGN KEY (`Organization_idOrganization`)
  REFERENCES `AnatomicalAtlas`.`Organization` (`idOrganization`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Organization_has_Teacher_Teacher1`
  FOREIGN KEY (`Teacher_idEmployee`)
  REFERENCES `AnatomicalAtlas`.`Teacher` (`idTeacher`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `AnatomicalAtlas`.`QuizTestHasQuestion`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `AnatomicalAtlas`.`QuizTestHasQuestion` ;

CREATE TABLE IF NOT EXISTS `AnatomicalAtlas`.`QuizTestHasQuestion` (
  `QuizTest_idQuizTest` INT NOT NULL,
  `Question_idQuestion` INT NOT NULL,
  PRIMARY KEY (`Question_idQuestion`, `QuizTest_idQuizTest`),
  INDEX `fk_Question_has_QuizTest_QuizTest2_idx` (`QuizTest_idQuizTest` ASC),
  INDEX `fk_Question_has_QuizTest_Question2_idx` (`Question_idQuestion` ASC),
  CONSTRAINT `fk_Question_has_QuizTest_Question2`
  FOREIGN KEY (`Question_idQuestion`)
  REFERENCES `AnatomicalAtlas`.`Question` (`idQuestion`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Question_has_QuizTest_QuizTest2`
  FOREIGN KEY (`QuizTest_idQuizTest`)
  REFERENCES `AnatomicalAtlas`.`QuizTest` (`idQuizTest`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `AnatomicalAtlas`.`ClassHasStudent`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `AnatomicalAtlas`.`ClassHasStudent` ;

CREATE TABLE IF NOT EXISTS `AnatomicalAtlas`.`ClassHasStudent` (
  `Class_idClass` INT NOT NULL,
  `Student_idStudent` INT NOT NULL,
  PRIMARY KEY (`Class_idClass`, `Student_idStudent`),
  INDEX `fk_Class_has_Student_Student1_idx` (`Student_idStudent` ASC),
  INDEX `fk_Class_has_Student_Class1_idx` (`Class_idClass` ASC),
  CONSTRAINT `fk_Class_has_Student_Class1`
  FOREIGN KEY (`Class_idClass`)
  REFERENCES `AnatomicalAtlas`.`Class` (`idClass`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Class_has_Student_Student1`
  FOREIGN KEY (`Student_idStudent`)
  REFERENCES `AnatomicalAtlas`.`Student` (`idStudent`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
  ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
